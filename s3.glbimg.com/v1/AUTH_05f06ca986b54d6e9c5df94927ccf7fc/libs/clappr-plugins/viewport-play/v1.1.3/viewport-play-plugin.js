// [AIV_SHORT]  Build version: 1.1.3 - Tuesday, December 28th, 2021, 4:36:05 PM  
 var ViewportPlayPlugin=function(n){var i={};function o(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,o),t.l=!0,t.exports}return o.m=n,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)o.d(n,i,function(e){return t[e]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o(o.s=2)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMobileIOS=t.logging=t.env=void 0;var r=n(1),n=window.glb&&window.glb.getCurrentEnv&&window.glb.getCurrentEnv()||"local";t.env=n,t.logging=function(e){for(var t,n=arguments.length,i=Array(1<n?n-1:0),o=1;o<n;o++)i[o-1]=arguments[o];return console[e]||(e="log"),(t=console)[e].apply(t,["["+r.PLUGIN_NAME+"]"].concat(i))},t.isMobileIOS=function(){return!!(navigator.userAgent&&navigator.userAgent.toLowerCase()||"").match(/iPhone|iPad|iPod/i)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PLUGIN_NAME="viewport_play_plugin",t.DEFAULT_CONFIGS={threshold:.4,firstPlayThreshold:1,timeout:500}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return n(3)},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r,a=n(4),s=(r=a)&&r.__esModule?r:{default:r},u=n(1),l=n(0);var n=Clappr,c=n.Events,n=n.CorePlugin,f=WP3.Events,i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(p,n),i(p,[{key:"name",get:function(){return u.PLUGIN_NAME}},{key:"supportedVersion",get:function(){return{min:Clappr.version}}},{key:"isAd",get:function(){return"ad"===this.container.getPlaybackType()}},{key:"deviceGroup",get:function(){return window.cdaaas&&window.cdaaas.SETTINGS&&window.cdaaas.SETTINGS.MOBILE_GROUP||"desktop"}},{key:"enableViewportPlay",get:function(){return this.options.enableViewportPlay||!1}},{key:"shouldInit",get:function(){var e="smart"===this.deviceGroup,t=navigator&&navigator.connection&&"wifi"===navigator.connection.type;return e&&t||!e||(0,l.isMobileIOS)()}},{key:"hasABExperiment",get:function(){return this.options.alternativeViewportPlay&&this.options.experimentViewportPlay}},{key:"isPlaying",get:function(){return this.container.isPlaying()}}]),i(p,[{key:"setPluginOptions",value:function(){this.pluginOptions=this.options.ViewportPlayPlugin||{};var e=this.pluginOptions,t=e.firstPlayThreshold,n=e.threshold,i=e.timeout,e=e.viewportPlayCallback;this.firstPlayThreshold=t||u.DEFAULT_CONFIGS.firstPlayThreshold,this.threshold=n||u.DEFAULT_CONFIGS.threshold,this.timeout=i||u.DEFAULT_CONFIGS.timeout,this.viewportPlayCallback=e||null}},{key:"setABExperiment",value:function(){var e=this.options.alternativeViewportPlay,t=this.options.experimentViewportPlay,n=this.options.testIdViewportPlay||"";this.abExperiment={name:t,testId:n,alternative:e}}},{key:"setUpImpressionObserver",value:function(){var n=this;this.createIntersectionObserver(function(e,t){return n.sendImpressionCallback(e,t)},this.firstPlayThreshold)}},{key:"setUpObserver",value:function(){var n=this,e=this.getOberserverTreshold();this.createIntersectionObserver(function(e,t){return n.observerCallback(e,t)},e)}},{key:"getOberserverTreshold",value:function(){return this.threshold===this.firstPlayThreshold?this.threshold:[this.threshold,this.firstPlayThreshold]}},{key:"sendImpressionCallback",value:function(e,i){var o=this;e.forEach(function(e){var t,n;window.hasSentImpressionViewportPlay?i.unobserve(e.target):e.isIntersecting&&(t=(n=o.abExperiment).alternative,n=n.testId,o.abClient.sendImpression(t,n),window.hasSentImpressionViewportPlay=!0,i.unobserve(e.target))})}},{key:"createIntersectionObserver",value:function(n,e){window.IntersectionObserver&&new IntersectionObserver(function(e,t){n(e,t)},{threshold:e}).observe(this.core.el)}},{key:"observerCallback",value:function(e,t){var n=this;e.forEach(function(e){e=e.intersectionRatio;n.enabled&&(n.isVideoInViewport(e)?n.playVideo():(n.pauseVideoPlaying(),n.clearVideoTimeout()))})}},{key:"isVideoInViewport",value:function(e){return(this.isAlreadyPlayed?this.threshold:this.firstPlayThreshold)<=e}},{key:"playVideo",value:function(){this.isPlaying||this.isVideoEnded||this.playWithDelay()}},{key:"playWithDelay",value:function(){var e=this;null===this.videoTimeoutId&&(this.videoTimeoutId=setTimeout(function(){e.enabled&&(e.container.play(),e.isAlreadyPlayed=!0,e.viewportPlayCallback&&e.viewportPlayCallback(e.container.options.source))},this.timeout))}},{key:"pauseVideoPlaying",value:function(){this.isPlaying&&this.container.pause()}},{key:"clearVideoTimeout",value:function(){null!==this.videoTimeoutId&&(clearTimeout(this.videoTimeoutId),this.videoTimeoutId=null)}},{key:"bindEvents",value:function(){this.listenTo(this.core.mediaControl,c.MEDIACONTROL_CONTAINERCHANGED,this.onContainerChanged)}},{key:"onContainerChanged",value:function(){this.container&&(this.isVideoEnded=!1,this.stopListening(this.container)),this.container=this.core.getCurrentContainer(),this.listenTo(this.container,c.CONTAINER_ENDED,this.onEnded),this.listenTo(this.container,c.CONTAINER_PLAY,this.onPlay),this.listenToOnce(this.container,f.WM_UNMUTED,this.onUnmuted)}},{key:"onPlay",value:function(){var e,t;!this.hasABExperiment||this.hasSentConversion||this.isAd||(e=(t=this.abExperiment).alternative,t=t.testId,this.hasSentConversion=!0,this.abClient.sendConversion(e,t))}},{key:"onUnmuted",value:function(){this.core.configure({mute:!1})}},{key:"onEnded",value:function(){this.isVideoEnded=!0}}]),p);function p(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(p.__proto__||Object.getPrototypeOf(p)).call(this,e));return t.core=e,t.enabled=!1,t.isVideoEnded=!1,t.isAlreadyPlayed=!1,t.videoTimeoutId=null,t.uniqueId=t.core.uniqueId,t.setPluginOptions(),t.hasABExperiment&&(t.setABExperiment(),t.hasSentConversion=!1,t.abClient=new s.default(t.abExperiment.name),t.setUpImpressionObserver()),t.enableViewportPlay&&t.shouldInit&&(t.setUpObserver(),t.enable()),t}t.default=i,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r,a=n(5),s=(r=a)&&r.__esModule?r:{default:r},u=n(0);var l=new s.default(u.env),i=(i(c,[{key:"_sendCustom",value:function(e,t,n){return(0,u.logging)("log","Enviando "+e+" para o experimento "+this.experimentName+" para alternativa "+t,"com testId "+n),l[e]({experiment:this.experimentName,alternative:t,testId:n})}},{key:"send",value:function(t){try{for(var e=arguments.length,n=Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];this._sendCustom.apply(this,[t].concat(n))}catch(e){(0,u.logging)("error","Falha ao enviar "+t+" para teste AB: "+this.experimentName+"."),(0,u.logging)("error",e)}}},{key:"sendImpression",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.send.apply(this,["impression"].concat(t))}},{key:"sendConversion",value:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.send.apply(this,["conversion"].concat(t))}}]),c);function c(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),this.experimentName=e}t.default=i,e.exports=t.default},function(e,n,t){"use strict";!function(e){var t,s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t=function(){return n=[function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(9),i=(i(a,[{key:"getParams",value:function(e){var t={skipImpressions:this.isSkippedImpression()};return Object.assign({},t,e)}},{key:"getLocationParams",value:function(){return{drawed:!0,countImpressions:!this.isSkippedImpression()}}},{key:"getHeaders",value:function(){return this.options.extraHeaders||[]}},{key:"getHeader",value:function(n){var i="";return this.getHeaders().forEach(function(t){Object.keys(t).forEach(function(e){n===e&&(i=t[e])})}),i}},{key:"getDict",value:function(){return this.options}},{key:"getTimeout",value:function(){var e=this.options.timeout;return e=void 0===e?1e3:e}},{key:"skipImpression",value:function(){return this.options.skipImpressions=!0,this}},{key:"timeout",value:function(e){return this.options.timeout=e,this}},{key:"isFieldSetted",value:function(e){return void 0!==e&&!1!==e}},{key:"isSkippedImpression",value:function(){return this.isFieldSetted(this.options.skipImpressions)}},{key:"addHeader",value:function(e){var t=[];return(t=this.options.hasOwnProperty("extraHeaders")?this.options.extraHeaders:t).push(e),this.options.extraHeaders=t,this}},{key:"withOriginURL",value:function(e){return new a(this.clone(this.options)).originURL(e)}},{key:"originURL",value:function(e){return this.addHeader({"x-canonical-uri":e}),this}},{key:"getOriginURL",value:function(){return this.getHeader("x-canonical-uri")}},{key:"enableGADebugger",value:function(){return this.options.enableGADebugger=!0,this}},{key:"isEnabledGADebugger",value:function(){return this.isFieldSetted(this.options.enableGADebugger)}},{key:"clone",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"withContext",value:function(e){return this.options.context=r.validated(e),this}},{key:"getContext",value:function(){return this.options.context||[]}}],[{key:"validated",value:function(e){if(e instanceof a)return e;if(void 0===e)return new a;throw new TypeError("GloboABOptions não válido")}}]),a);function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.options=e}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var v=n(10),i=(i(r,[{key:"oneWaySend",value:function(e,t,n,i){this.do("PUT",e,null,t,null,null,n,i)}},{key:"do",value:function(e,t,n,i,o,r){var a,s=this,u=6<arguments.length&&void 0!==arguments[6]?arguments[6]:[],l=7<arguments.length&&void 0!==arguments[7]?arguments[7]:1e3,c="",f=v.interceptParams(t,n);for(a in f)f.hasOwnProperty(a)&&(c+="&"+a+"="+f[a]);var c=c&&"?"+c.substring(1),p=this.abHost+t+c,h=this.createXHR();h.open(e,p,!0),h.timeout=l,h.onload=function(){200<=h.status&&h.status<400?s.callIfDefined(o,h):s.callIfDefined(r,s.handleError(h,p))},h.onerror=function(e){s.callIfDefined(r,s.handleError(e,p))},h.ontimeout=function(e){s.callIfDefined(r,s.handleError(e,p))},i&&(h.setRequestHeader("Content-Type","application/json;charset=utf-8"),i=JSON.stringify(i)),Array.from(u).forEach(function(t){Object.keys(t).forEach(function(e){h.setRequestHeader(e,t[e])})}),h.send(i)}},{key:"handleError",value:function(e,t){var n={};return n.type=e.type||"undefined",(e=e.target instanceof XMLHttpRequest?e.target:e)instanceof XMLHttpRequest?(n.status=e.status,n.url=t,n.timeout=e.timeout,n.msg=e.responseText):n.msg=e.toString(),n}},{key:"createXHR",value:function(){var e=new XMLHttpRequest;return e.withCredentials=!0,e}},{key:"callIfDefined",value:function(e,t){e&&e(t)}}]),r);function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.abHost=e}e.exports=i},function(e,t,n){var i="function"==typeof Symbol&&"symbol"===s(Symbol.iterator)?function(e){return void 0===e?"undefined":s(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":void 0===e?"undefined":s(e)},o=function(){return this}();try{o=o||Function("return this")()||(0,eval)("this")}catch(e){"object"===("undefined"==typeof window?"undefined":i(window))&&(o=window)}e.exports=o},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(1),a=n(16),i=(i(s,[{key:"selectedAlternatives",value:function(e,t,n,i){this.request.do("GET","/v2/selected-alternatives",t.getParams({experiments:e}),null,n,i,t.getHeaders(),t.getTimeout())}},{key:"chooseWithContext",value:function(e,t,n,i){e=t.getParams({experiments:[e]});this.request.do("POST","/choose",{},Object.assign(e,{context:t.getContext()}),n,i,t.getHeaders(),t.getTimeout())}},{key:"recordMetric",value:function(e,t,n){e="/v2/tests/"+t.testId+"/"+e,t={experiment:t.experiment,alternative:t.alternative,context:n.getContext()};this.requestWrapper.oneWay(e,t,n.getHeaders(),n.getTimeout())}}]),s);function s(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.abHost=e,this.request=new r(this.abHost),this.requestWrapper=new a(this.abHost)}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(0),i=(i(s,[{key:"isValid",value:function(){return"string"==typeof this.experiment&&""!==this.experiment.trim()&&"string"==typeof this.alternative&&""!==this.alternative.trim()&&"string"==typeof this.testId&&""!==this.testId.trim()}},{key:"impression",value:function(e){this.isValid()?(e=e||this.options,this._sendMetric("impression",e)):console.warn("Os dados do exp não são válidos para impressão")}},{key:"conversion",value:function(e){this.isValid()?(e=e||this.options,this._sendMetric("conversion",e)):console.warn("Os dados do exp não são válidos para conversão!")}},{key:"_canProcessEvent",value:function(){return!(this.data&&this.data["extra-info"]&&this.data["extra-info"]["draw-rule"]&&void 0!==this.data["extra-info"]["draw-rule"]["process-event"])||this.data["extra-info"]["draw-rule"]["process-event"]}},{key:"_sendMetric",value:function(e){var t,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:this.options;this._canProcessEvent()?(t={experiment:this.experiment,alternative:this.alternative,testId:this.testId},this.context.abEndpoint.recordMetric(e,t,n)):console.warn("Nao será enviado sinais de impressão ou conversão, uma vez que o experimento foi finalizado ou desativado.")}},{key:"_getPropertiesFromData",value:function(){var n={};return(Array.isArray(this.data.properties)?this.data.properties:[]).forEach(function(e){var t=e.key,e=e.value;n[t]=e}),n}},{key:"_getStringFromData",value:function(e){return"string"==typeof this.data[e]?this.data[e]:null}}],[{key:"parseRequest",value:function(e,t,n){var i,o,r=JSON.parse(e),a={};for(i in r.experiments)r.experiments.hasOwnProperty(i)&&(o=new s(r.experiments[i],t,n),a[i]=o);return a}}]),s);function s(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,s),this.data=e||{},this.context=t,this.options=n,this.experiment=this._getStringFromData("experiment"),this.alternative=this._getStringFromData("alternative"),this.testId=this._getStringFromData("testId"),this.properties=this._getPropertiesFromData()}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(0),a=n(3),s=n(4),i=(i(u,[{key:"options",value:function(){return this._options}},{key:"impression",value:function(e,t){this._getExperiment(e,t).impression()}},{key:"conversion",value:function(e,t){this._getExperiment(e,t).conversion()}},{key:"choose",value:function(e){return"string"==typeof e&&""!==e.trim()?this._chooseOne(e):Array.isArray(e)&&0<e.length?this._chooseMulti(e):Promise.reject(new TypeError("Para sorteio o experimento precisa ser uma string ou uma lista válida."))}},{key:"_chooseOne",value:function(i){var o=this;return 0<this._options.getContext().length?new Promise(function(t,n){o.abEndpoint.chooseWithContext(i,o.options(),function(e){e=s.parseRequest(e.responseText,o,o.options())[i];t(e)},function(e){n(e)})}):new Promise(function(t,n){o.abEndpoint.selectedAlternatives(i,o.options(),function(e){e=s.parseRequest(e.responseText,o,o.options())[i];t(e)},function(e){n(e)})})}},{key:"_chooseMulti",value:function(e){var i=this,o=e.join(",");return new Promise(function(t,n){i.abEndpoint.selectedAlternatives(o,i.options(),function(e){e=s.parseRequest(e.responseText,i,i.options());t(e)},function(e){n(e)})})}},{key:"_getExperiment",value:function(e,t){t=t||this._options;return void 0!==e&&e.__proto__&&e.__proto__.constructor&&"Experiment"===e.__proto__.constructor.name?(e.options=t,e):new s(e,this,t)}}]),u);function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this.server=e,this.abEndpoint=new a(this.server),this._options=t}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(12),a=n(11),s=n(0),i=(i(u,[{key:"options",value:function(){return this._options}},{key:"choose",value:function(e){var i=this;return 0<this.options().getContext().length?new Promise(function(t,n){i.abEndpoint.chooseLocationWithContext(e,i.options(),function(e){e=r.parseRequest(e.responseText,i,i.options());t(e)},function(e){n(e)})}):new Promise(function(t,n){i.abEndpoint.selectedDrawedExperiment(e,i.options(),function(e){e=r.parseRequest(e.responseText,i,i.options());t(e)},function(e){n(e)})})}}]),u);function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this.server=e,this.abEndpoint=new a(this.server),this._options=t}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(0),a=n(13),s=n(14),i=(i(u,[{key:"options",value:function(){return this._options}},{key:"increment",value:function(e){var t=e.experiment,n=e.arm,i=e.testId,o=e.abAlternative,e=e.arms;new s({experiment:t,arm:n,testId:i,abAlternative:o,arms:void 0===e?[]:e},this,this.options()).increment()}},{key:"reward",value:function(e){var t=e.experiment,n=e.arm,i=e.testId,o=e.abAlternative,e=e.slot,e=void 0===e?0:e;new s({experiment:t,arm:n,testId:i,abAlternative:o},this,this.options()).reward(e,n)}},{key:"choose",value:function(e){return"string"==typeof e&&""!==e.trim()?this._chooseOne(e):Array.isArray(e)&&0<e.length?this._chooseMulti(e):Promise.reject(new TypeError("Para sorteio o experimento precisa ser uma string ou uma lista válida."))}},{key:"_chooseOne",value:function(i){var o=this;return new Promise(function(t,n){o.mabEndpoint.getSelectedArm(i,o.options(),function(e){e=s.parseRequest(e.responseText,i,o,o.options());t(e)},function(e){n(e)})})}},{key:"_chooseMulti",value:function(e){var i=this,o=e.join(",");return new Promise(function(t,n){i.mabEndpoint.getSelectedArms(o,i.options(),function(e){e=s.parseRequestWithQueryString(e.responseText,i,i.options());t(e)},function(e){n(e)})})}}]),u);function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:new r;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this.server=e,this._options=t,this.mabEndpoint=new a(this.server)}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(0),a=n(5),s=n(7),u=n(6),i=(i(l,[{key:"createOptions",value:function(){return this._options=new r,this.abMain=new a(this._getServer(this.env),this._options),this._options}},{key:"options",value:function(){return this._options}},{key:"mab",value:function(){return new s(this._getMabServer(this.env),this.options())}},{key:"location",value:function(){return new u(this._getServer(this.env),this.options(),this.context)}},{key:"impression",value:function(e,t){this.abMain.impression(e,t)}},{key:"conversion",value:function(e,t){this.abMain.conversion(e,t)}},{key:"choose",value:function(e){return this.abMain.choose(e)}},{key:"_getEnv",value:function(e){return"prod"===e||"prod.be"===e||"qa"===e||"qa.be"===e||"local"===e?e:"qa"}},{key:"_getServer",value:function(e){return"local"===this.env?"http://localhost:8888":"prod"===this.env?"https://globo-ab.globo.com":"prod.be"===this.env?"http://be.globo-ab.globoi.com":"qa.be"===this.env?"http://be.globo-ab.qa.globoi.com":"https://globo-ab.qa.globoi.com"}},{key:"_getMabServer",value:function(e){return"local"===this.env?"http://localhost:8888":"prod"===this.env?"https://globo-mab.globo.com":"prod.be"===this.env?"http://be.globo-mab.globoi.com":"qa.be"===this.env?"http://be.globo-mab.qa.globoi.com":"https://globo-mab.qa.globoi.com"}}]),l);function l(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,l),this.env=this._getEnv(e),this._options=new r,this.abMain=new a(this._getServer(this.env),this._options)}e.exports=i},function(e,t,n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var o=(function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(r,null,[{key:"validated",value:function(e){if(Array.isArray(e)&&this.isValid(e))return e;if(void 0===e)return[];throw new TypeError("Contexto não válido")}},{key:"isValid",value:function(e){for(var t=!0,n=0;n<e.length;n++)t=t&&"string"==typeof e[n].name&&"string"==typeof e[n].value;return t}}]),r);function r(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.context=e}e.exports=o},function(n,e,t){!function(e){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var t=(function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(r,null,[{key:"getPluginParams",value:function(){var e,t,n={},i=["ab-client-context","ab-client-experiment","ab-client-alternative"],o=r.getDocumentLocationSearch().substr(1).split("&");for(e in o)o.hasOwnProperty(e)&&(t=o[e].split("="),-1<i.indexOf(t[0])&&(n[t[0]]=t[1]));return n}},{key:"getDocumentLocationSearch",value:function(){return document.location.search}},{key:"isCompatibleWithPlugin",value:function(){return void 0!==e.window}},{key:"interceptParams",value:function(e,t){try{if(r.isCompatibleWithPlugin()&&e){var n,i=void 0,o=void 0;if(-1<e.indexOf("/location/")?i=(n=e.split("/"))[n.length-1]:-1<e.indexOf("selected-alternatives")&&(o=t.experiments||t.experiment),o||i)return Object.assign({},t,this.getExperimentSettings(i,o))}}catch(e){console.error(e)}return t}},{key:"getExperimentSettings",value:function(e,t){var n=this.getPluginParams();if(e&&n["ab-client-context"]===e&&n["ab-client-experiment"]){e={experiment:n["ab-client-experiment"],alternative:n["ab-client-alternative"]};return e.alternative||delete e.alternative,e}return t&&t.includes(n["ab-client-experiment"])&&n["ab-client-alternative"]?{alternative:n["ab-client-alternative"]}:{}}}]),r);function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r)}n.exports=t}.call(e,t(2))},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(1),n=n(3),i=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+(void 0===t?"undefined":s(t)));e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(a,n),i(a,[{key:"selectedDrawedExperiment",value:function(e,t,n,i){this.request.do("GET","/ab/location/"+e,t.getLocationParams(),null,n,i)}},{key:"chooseLocationWithContext",value:function(e,t,n,i){this.request.do("POST","/location/"+e+"/choose",{},Object.assign(t.getLocationParams(),{context:t.getContext()}),n,i)}}]),a);function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a);var t=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==(void 0===t?"undefined":s(t))&&"function"!=typeof t?e:t}(this,(a.__proto__||Object.getPrototypeOf(a)).call(this,e));return t.abHost=e,t.request=new r(t.abHost),t}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(4),i=(i(a,null,[{key:"parseRequest",value:function(e,t,n){var i=JSON.parse(e),o=Object.keys(i)[0],e=i[o],i=e.alternative,e=e.testId;return new r({experiment:o,alternative:i,testId:e},t,n)}}]),a);function a(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a)}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var r=n(1),i=(i(a,[{key:"getSelectedArm",value:function(e,t,n,i){var o="",r="GET";t.isSkippedImpression()?o="/mab/"+e+"/choose":(o="/mab/"+e+"/chooseAndIncrement",r="POST"),this.request.do(r,o,null,null,n,i,t.getHeaders(),t.getTimeout())}},{key:"getSelectedArms",value:function(e,t,n,i){var o="",o=t.isSkippedImpression()?"/choose":"/chooseAndIncrement";this.request.do("GET",o,t.getParams({experiments:e}),null,n,i,t.getHeaders(),t.getTimeout())}},{key:"recordMABMetric",value:function(e,t,n){var i="/mab/"+t.experiment+"/"+e,e=t.arms||[],e={arm:t.arm,testId:t.testId,abAlternative:t.abAlternative,arms:e};this.request.do("POST",i,{},e,null,null,n.getHeaders(),n.getTimeout())}}]),a);function a(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),this.abHost=e,this.request=new r(this.abHost)}e.exports=i},function(e,t,n){var i=function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e};function o(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var s=n(0),i=(i(u,[{key:"increment",value:function(){var e=this.arms;0===e.length&&(e=[{slot:0,name:this.arm}]),this._sendMetric("increment",e)}},{key:"reward",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"",t=[{slot:e,name:""===t?this.arm:t}];this._sendMetric("reward",t)}},{key:"_sendMetric",value:function(e,t){t={experiment:this.experiment,arm:this.arm,testId:this.testId,abAlternative:this.abAlternative,arms:t};this._recordMetric(e,t)}},{key:"_recordMetric",value:function(e,t){this.context.mabEndpoint.recordMABMetric(e,t,this.options)}}],[{key:"parseRequest",value:function(e,t,n,i){e=JSON.parse(e);return e.experiment=t,new u(e,n,i)}},{key:"parseRequestWithQueryString",value:function(e,t,n){var i,o,r=JSON.parse(e),a={};for(i in r)r.hasOwnProperty(i)&&(r[i].experiment=i,o=new u(r[i],t,n),a[i]=o);return a}}]),u);function u(e,t){var n=e.experiment,i=e.arm,o=e.testId,r=e.abAlternative,a=e.arms,e=void 0===a?[]:a,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:new s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),this.experiment=n,this.arm=i,this.testId=o,this.abAlternative=r,this.arms=e,this.context=t,this.options=a}e.exports=i},function(o,e,t){!function(n){function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var e=(function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}(t,[{key:"send",value:function(e,t){n.navigator.sendBeacon(this.abHost+e,JSON.stringify(t))}}]),t);function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this.abHost=e}o.exports=e}.call(e,t(2))},function(a,e,s){!function(e){var t=function(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e};function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var n=s(15),o=s(1),t=(t(r,[{key:"oneWay",value:function(e,t,n,i){this.isBrowserSupportSendBeacon()&&!this.hasHeaders(n)?this.sendBeaconOneWay.send(e,t):this.xmlHttp.oneWaySend(e,t,n,i)}},{key:"isBrowserSupportSendBeacon",value:function(){return!(void 0===e.navigator||!e.navigator.sendBeacon)}},{key:"hasHeaders",value:function(e){return void 0!==e&&0<e.length}}]),r);function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this.host=e,this.sendBeaconOneWay=new n(this.host),this.xmlHttp=new o(this.host)}a.exports=t}.call(e,s(2))}],o={},i.m=n,i.c=o,i.i=function(e){return e},i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=8);function i(e){if(o[e])return o[e].exports;var t=o[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}var n,o},"object"===s(n)&&"object"===s(e)?e.exports=t():void 0===(t="function"==typeof(t=t)?t.apply(n,[]):t)||(e.exports=t)}.call(this,t(6)(e))},function(e,t,n){"use strict";e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}}]); 